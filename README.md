# SVM车牌识别


该项目主要研究内容是基于OpenCV的SVM车牌识别系统，用于提取不同场景下的车牌信息，通过利用计算机视觉、图像处理技术以及模式识别的方法来进行车牌的自动检测和定位、车牌的分割以及字符的提取和识别工作，同时根据定位和识别运用到的算法进行了研究以及实验结果的分析。本课题的目标主要是在OpenCV开发构建一个车牌识别系统，实现对图片或相机中的车辆进行车牌识别，输出车牌信息。


该车牌识别系统主要是由车牌定位、字符分割、字符识别这三个部分组成。在字符识别部分提出用基于改进的支持向量机的识别方法进行车牌字符的识别，利用训练好的支持向量机进行字符识别。

### 详细设计
##### (1)main_car.py
主要为前端界面的设计。


##### (2)img_function.py
①　train_svm(self)
初始化SVM实例，设置属性。这是opencv自带的。
Svm.dat如果存在，不再训练，直接导入训练好的结果
依次读取train\chars2目录中训练用图片，转化为灰度图，保存到训练数据集合。
保存分类标签到对应的标签集合。每个字符图片保存在以该字符名称对应的目录中，所以把目录名称对应的ASCII码作为训练数据的分类。
调用deskew函数，对训练图片（灰度图）进行抗扭曲处理，摆正。
map() 会根据提供的函数对指定序列做映射。
调用hog函数，获得每张图片的特征向量。
调用SVM实例的train方法，送入训练数据集合和标签集合进行机器学习。
每个字符图片保存在以该字符名称对应的目录中，所以把目录名称对应的ASCII码作为训练数据的分类。
学习结果（支持向量机）保存在svm.dat文件中，用于识别图片（车牌）时候使用。识别是利用svm的predict方法，也是opencv中自带的。
②　img_first_pre(self, car_pic_file)
缩小图片；滤波去噪；转化成灰度图像；创建20*20的元素为1的矩阵 开操作，并和img重合；二值化；找到图像边缘。
③　img_color_contours(self, img_contours, oldimg)
轮廓提取；进行矩形矫正；根据颜色判断，缩小边界。
接下来是识别字符、定位车牌图像、判断车牌颜色。
黄、绿车牌字符比背景暗、与蓝车牌刚好相反，所以黄、绿车牌需要反向；查找水平直方图波峰，认为水平方向最大的波峰为车牌区域；去掉车牌上下边缘1个像素，避免白边影响阈值判断；U和0要求阈值偏小，否则U和0会被分成两半；判断是否是左侧车牌边缘；组合分离汉字；除车牌上的分隔点；判断最后一个数是否是车牌边缘，假设车牌边缘被认为是1。
返回识别到的字符、定位的车牌图像、车牌颜色。
④　img_mser(self, filename)
文字检测算法。该算法可以用来粗略地定位出图像中的文字区域位置。
调用 MSER 算法；对一幅灰度图像取不同的阈值进行二值化处理；获取文本区域；将不规则检测框处理成矩形框。
##### (3)img_math.py
该文件包含读文件函数、取零值函数、矩阵校正函数、颜色判断函数。
①　img_read(filename)
以uint8方式读取filename 放入imdecode中，cv2.IMREAD_COLOR读取彩色照片；
②　accurate_place(card_img_hsv, limit1, limit2, color)
根据颜色定位车牌大致范围。
③　img_findContours(img_contours)
查找图像边缘整体形成的矩形区域，可能有很多，车牌就在其中一个矩形区域中；排除不是车牌的矩形区域，排除面积最小的点；要求矩形区域长宽比在2到5.5之间，2到5.5是车牌的长宽比，其余的矩形排除。
④　img_Transform(car_contours, oldimg, pic_width, pic_hight)
进行矩形矫正，矩形区域可能是倾斜的矩形，需要矫正，以便使用颜色定位；创造角度，使得左、高、右、低拿到正确的值；扩大范围，避免车牌边缘被排除；分为正角度和负角度两张情况进行计算。
⑤　img_color(card_imgs)
开始使用颜色定位，排除不是车牌的矩形，目前只识别蓝、绿、黄车牌；确定车牌颜色；根据车牌颜色再定位，缩小边缘非车牌边界；最终确定车牌定位。
⑥　find_waves(threshold, histogram)
根据设定的阈值和图片直方图，找出波峰，用于分隔字符。
⑦　seperate_card(img, waves)
根据找出的波峰，分割图片，从而得到逐个字符图片。
##### (4)img_recognition.py
①　deskew(img)
对训练图片（灰度图）进行抗扭曲处理，摆正。
②　preprocess_hog(digits)
用于从图片中抽取特征向量。
计算图像 X 方向和 Y 方向的 Sobel 导数；计算得到每个像素的梯度角度angle和梯度大小magnitude；把这个梯度的角度转换成 0至16 之间的整数；将图像分为4个小的方块，对每一个小方块计算它们梯度角度的直方图histogram（16个 bin），使用梯度的大小做权重。每一个小方块都会得到一个含有16个值的向量，4 个小方块的4个向量就组成了这个图像的特征向量。
